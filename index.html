<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹å†™ç¬”è®°</title>
    <style>
        body { font-family: system-ui; max-width: 600px; margin: 40px auto; padding: 0 20px; }
        a { color: #0066cc; text-decoration: none; }
        a:hover { text-decoration: underline; }
        li { margin: 8px 0; }
        #back { margin-bottom: 20px; }
    </style>
</head>
<body>
    <h2>ğŸ“’ æ‰‹å†™ç¬”è®°</h2>
    <div id="back"></div>
    <ul id="list"><li>åŠ è½½ä¸­...</li></ul>

    <script>
        const USER = 'time2024', REPO = 'courses';
        const ignore = ['index.html', 'LICENSE', 'README.md', '.gitignore'];
        const path = new URLSearchParams(location.search).get('path') || '';
        
        if (path) {
            const parent = path.includes('/') ? '?path=' + path.substring(0, path.lastIndexOf('/')) : '?';
            document.getElementById('back').innerHTML = `<a href="${parent}">â¬… è¿”å›ä¸Šçº§</a>`;
        }

        fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`)
            .then(r => r.json())
            .then(data => {
                const list = document.getElementById('list');
                list.innerHTML = '';
                
                const items = data
                    .filter(f => !ignore.includes(f.name))
                    .sort((a, b) => {
                        if (a.type === 'dir' && b.type !== 'dir') return -1;
                        if (a.type !== 'dir' && b.type === 'dir') return 1;
                        return a.name.localeCompare(b.name, 'zh-CN', { numeric: true });
                    });

                items.forEach(f => {
                    const li = document.createElement('li');
                    if (f.type === 'dir') {
                        li.innerHTML = `ğŸ“ <a href="?path=${path ? path + '/' : ''}${f.name}">${f.name}</a>`;
                    } else {
                        li.innerHTML = `ğŸ“„ <a href="${f.download_url}" target="_blank">${f.name}</a>`;
                    }
                    list.appendChild(li);
                });
            });
    </script>
</body>
</html>
